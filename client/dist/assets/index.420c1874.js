import{S as e,w as t,R as a,D as r,a as o,L as n,B as s,b as c,c as l,i as m,d as u}from"./vendor.4c4fbbea.js";const d=e.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,onOpen:t=>{t.addEventListener("mouseenter",e.stopTimer),t.addEventListener("mouseleave",e.resumeTimer)}}),i=(e,t)=>{d.fire({icon:e,title:t})};var p=t((function(e){const t=a.createRef(),o=a.createRef();return a.createElement("div",{className:"card"},a.createElement("div",{className:"cardHeader"},"Login"),a.createElement("div",{className:"cardBody"},a.createElement("div",{className:"inputGroup"},a.createElement("label",{htmlFor:"player"},"Your name"),a.createElement("input",{type:"text",name:"text",id:"player",autoFocus:!0,placeholder:" ercode",ref:t})),a.createElement("div",{className:"inputGroup"},a.createElement("label",{htmlFor:"password"},"Password"),a.createElement("input",{type:"password",name:"password",id:"password",placeholder:" your password",ref:o})),a.createElement("button",{onClick:()=>{const a=t.current.value,n=o.current.value;r.post("/login",{name:a,password:n}).then((t=>{i("success",t.data.message),console.log(t.data),t.data.token&&(localStorage.setItem("Auth_token",t.data.token),e.history.push("/dashboard"),e.setupSocket())})).catch((e=>{i("error",e.res.data.message)}))}},"Sign in")))}));function E(e){const t=a.createRef(),o=a.createRef();return a.createElement("div",{className:"card"},a.createElement("div",{className:"cardHeader"},"Register"),a.createElement("div",{className:"cardBody"},a.createElement("div",{className:"inputGroup"},a.createElement("label",{htmlFor:"player"},"Your name"),a.createElement("input",{type:"text",name:"text",id:"player",autoFocus:!0,placeholder:" ercode",ref:t})),a.createElement("div",{className:"inputGroup"},a.createElement("label",{htmlFor:"password"},"Password"),a.createElement("input",{type:"password",name:"password",id:"password",placeholder:" your password",ref:o})),a.createElement("button",{onClick:()=>{const a=t.current.value,n=o.current.value;r.post("/register",{name:a,password:n}).then((t=>{i("success",t.data.message),console.log(t.data),e.history.push("/login")})).catch((e=>{i("error",e.res.data.message)}))}},"Sign up")))}function g(e){const[t,s]=o.exports.useState([]),c=async()=>{try{const{data:e}=await r.get("/rooms",{headers:{auth:localStorage.getItem("Auth_token")}});s(e)}catch(e){setTimeout(c,3e3)}};return o.exports.useEffect((()=>{c()}),[]),a.createElement("div",{className:"card"},a.createElement("div",{className:"cardHeader"},"Lobby"),a.createElement("div",{className:"cardBody"},a.createElement("div",{className:"inputGroup"},a.createElement("label",{htmlFor:"gameroom"},"Room name"),a.createElement("input",{type:"text",name:"gameroom",id:"gameroom",autoFocus:!0,placeholder:" secret room"})),a.createElement("button",null,"Create"),a.createElement("div",{className:"gamerooms"},t.map((e=>a.createElement("div",{key:e._id,className:"gameroom"},a.createElement("div",null,e.name),a.createElement(n,{to:"/room/"+e._id},a.createElement("div",{className:"join"},"Join"))))))))}function h(e){return a.useEffect((()=>{localStorage.getItem("Auth_token")?e.history.push("/dashboard"):e.history.push("/login")}),[]),a.createElement("div",null,"Homepage")}var v=t((function({match:e,socket:t}){const r=e.params.id,[n,s]=o.exports.useState([]),[c,l]=o.exports.useState(""),m=o.exports.useRef();return o.exports.useEffect((()=>{const e=localStorage.getItem("Auth_token");if(e){const t=JSON.parse(atob(e.split(".")[1]));l(t.id)}t&&t.on("newMessage",(e=>{s([...n,e])}))}),[n]),o.exports.useEffect((()=>(t&&t.emit("joinRoom",{gameroomID:r}),()=>{t&&t.emit("leaveRoom",{gameroomID:r})})),[]),a.createElement("div",{className:"gameroomPage"},a.createElement("div",{className:"gameroomSection"},a.createElement("div",{className:"cardHeader"},"Chatroom Name"),a.createElement("div",{className:"gameroomContent"},n.map(((e,t)=>a.createElement("div",{key:t,className:c===e.playerID?"own":"message"},a.createElement("span",{className:c===e.playerID?"ownMessage":"otherMessage"},e.name,":"," "),e.message)))),a.createElement("div",{className:"gameroomActions"},a.createElement("form",{onSubmit:e=>{e.preventDefault()}},a.createElement("div",null,a.createElement("input",{ref:m,type:"text",name:"message",placeholder:" say smt...",autoFocus:!0})),a.createElement("div",null,a.createElement("button",{onClick:()=>{t&&(t.emit("gameroomMessage",{gameroomID:r,message:m.current.value}),m.current.value="",m.current.focus())},className:"join"},"Send"))))))}));function f(){const[e,t]=o.exports.useState(0),[r,n]=o.exports.useState("");return a.createElement("div",{className:"App"},a.createElement("header",{className:"App-header"},a.createElement("p",null,"Hi, ",r),a.createElement("p",null,a.createElement("button",{onClick:()=>t((e=>e+1))},"test: ",e)),a.createElement("p",null,a.createElement("a",{className:"App-link",href:"https://vitejs.dev/guide/features.html",target:"_blank",rel:"noopener noreferrer"},"Vite"))))}function N(){const[e,t]=o.exports.useState(null),r=()=>{if(localStorage.getItem("Auth_token")&&!e){const e=m("https://okey.erkuttekoglu.com",{auth:{token:localStorage.getItem("Auth_token")}});e.on("disconnect",(()=>{t(null),setTimeout(r,3e3),i("error","Socket disconnected!")})),e.on("connect",(()=>{i("success","Socket connected!")})),t(e)}};return o.exports.useEffect((()=>{r()}),[]),a.createElement(s,null,a.createElement(c,null,a.createElement(l,{path:"/",component:h,exact:!0}),a.createElement(l,{path:"/login",render:()=>a.createElement(p,{setupSocket:r}),exact:!0}),a.createElement(l,{path:"/register",component:E,exact:!0}),a.createElement(l,{path:"/dashboard",render:()=>a.createElement(g,{socket:e}),exact:!0}),a.createElement(l,{path:"/test",component:f,exact:!0}),a.createElement(l,{path:"/room/:id",render:()=>a.createElement(v,{socket:e}),exact:!0})))}u.render(a.createElement(a.StrictMode,null,a.createElement(N,null)),document.getElementById("root"));
